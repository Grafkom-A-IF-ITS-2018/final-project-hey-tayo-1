<!DOCTYPE html>
<html>
<head>
	<title>
		Hey Tayo FP
	</title>
	<script src="js/aframe.min.js"></script>
  	<script src="js/aframe-super-shooter-kit.min.js"></script>
  	<script src="js/aframe-extras.min.js"></script>
  	<script src="js/build.js"></script>
  	<script src="js/countdown.js"></script>
  	<script type="text/javascript">
  		/** Shoot **/
  		AFRAME.registerComponent('click-to-shoot', {
  			init: function() {
  				document.body.addEventListener('mousedown', () => {
  					this.el.emit('shoot');
  				});
  			}
  		});
  		/** Hit handler **/
  		AFRAME.registerComponent('hit-handler', {
  			dependencies: ['material'],

		    init: function () {
		    	var color;
		        var el = this.el;

		        color = new THREE.Color();
		        color.set('#666');
		        el.components.material.material.color.copy(color);
		        el.addEventListener('hit', () => {
		        	color.addScalar(0.05);
		        	el.components.material.material.color.copy(color);
		        });

		        el.addEventListener('die', () => {
		        	color.setRGB(1, 0, 0);
		        	el.components.material.material.color.copy(color);
		        });
		    }
		});

		AFRAME.registerComponent('collison-check', {
    schema: {
      el: {
        type: 'selector'
      },
      radius: {
        default: 0
      },
      otherRadius: {
        default: 0
      },
      score:{
        type: 'int',
        default: 0
      },
      colliding:{
        default: false
      }
    },
    tick: function () {
      var el1 = this.el;
      var el2 = this.data.el;
      var dist = el1.object3D.getWorldPosition().distanceTo(el2.object3D.getWorldPosition());
      var entity = document.querySelector('#score');
      if (dist < this.data.radius + this.data.otherRadius) {
        if (!this.data.colliding){
          this.data.score++;
          this.data.colliding = true;
          entity.emit('updateScore');
          AFRAME.utils.entity.setComponentProperty(entity, 'text.value', "score \n" + this.data.score);
        }
      } else {
        this.data.colliding = false;
      }
    }
  });
  	</script>
</head>
<body>
	<a-scene background="color: #DADADA" countdown="start: 05:00; value: 00:00">
		<a-assets>
			<img id="grid" src="https://img.gs/bbdkhfbzkk/stretch/https://i.imgur.com/25P1geh.png">
			<img id="skyTexture" src="images/background.png">
		</a-assets>

		<a-entity id="pond">
			<a-entity ocean scale="39 1 39" material="color: #000000" density="20" opacity="0.8" speed="0.1"></a-entity>
			<a-box position = "0 0.5 -20" scale="40 1 1" material="color: #ccccc7"></a-box>
			<a-box position = "20 0.5 0" scale="1 1 41" material="color: #ccccc7"></a-box>
			<a-box position = "0 0.5 20" scale="40 1 1" material="color: #ccccc7"></a-box>
			<a-box position = "-20 0.5 0" scale="1 1 41" material="color: #ccccc7"></a-box>
		</a-entity>

		<a-entity id="platform" geometry="primitive:box; width: 15; height: 1; depth: 15;" position="0 0.5 0" material="color:#f3f3f3;"></a-entity>

	<a-entity id="score" position="-2.5 2 -2" rotation="0 45 0" text="width: 4; align: center; color: black; value: Score \n 000">
      <a-animation attribute="rotation" to="0 405 0"  easing="linear" fill="both" dur="800" begin="updateScore" > </a-animation>
      <a-box color="#fed6fa" position ="0 0 -0.05" scale="0.8 0.6 0.1"> </a-box>
      <a-box color="#fed6fa" position ="0 -0.7 -0.05" scale="0.1 1 0.1"> </a-box>
	</a-entity>

		<a-entity id="smallBox1" geometry="primitive:box; width: 2; height: 2; depth: 1;" position="-1.5 2    -5" rotation="0  0 0" material="color: #8b5a2b"></a-entity>
		<a-entity id="smallBox2" geometry="primitive:box; width: 2; height: 2; depth: 1;" position=" 1.5 2    -5" rotation="0  0 0" material="color: #8b5a2b"></a-entity>
		<a-entity id="smallBox3" geometry="primitive:box; width: 2; height: 2; depth: 1;" position=" 5   2  -1.5" rotation="0 90 0" material="color: #8b5a2b"></a-entity>
		<a-entity id="smallBox4" geometry="primitive:box; width: 2; height: 2; depth: 1;" position=" 5   2   1.5" rotation="0 90 0" material="color: #8b5a2b"></a-entity>
		<a-entity id="smallBox5" geometry="primitive:box; width: 2; height: 2; depth: 1;" position=" 1.5 2     5" rotation="0  0 0" material="color: #8b5a2b"></a-entity>
		<a-entity id="smallBox6" geometry="primitive:box; width: 2; height: 2; depth: 1;" position="-1.5 2     5" rotation="0  0 0" material="color: #8b5a2b"></a-entity>
		<a-entity id="smallBox7" geometry="primitive:box; width: 2; height: 2; depth: 1;" position="-5   2  -1.5" rotation="0 90 0" material="color: #8b5a2b"></a-entity>
		<a-entity id="smallBox8" geometry="primitive:box; width: 2; height: 2; depth: 1;" position="-5   2   1.5" rotation="0 90 0" material="color: #8b5a2b"></a-entity>

		<a-entity id="bigBox1" geometry="primitive:box; width: 2; height: 4; depth: 1;" position="-6 3 -6" rotation="0 45 0" material="color: #8b4513"></a-entity>
		<a-entity id="bigBox2" geometry="primitive:box; width: 2; height: 4; depth: 1;" position="6 3 -6" rotation="0 -45 0" material="color: #8b4513"></a-entity>
		<a-entity id="bigBox3" geometry="primitive:box; width: 2; height: 4; depth: 1;" position="6 3 6" rotation="0 45 0" material="color: #8b4513"></a-entity>
		<a-entity id="bigBox4" geometry="primitive:box; width: 2; height: 4; depth: 1;" position="-6 3 6" rotation="0 -45 0" material="color: #8b4513"></a-entity>

		<a-entity id="hangBox1" geometry="primitive:box; width: 3; height: 1; depth: 1;" position=" 0 6 -5" rotation="0  0 0" material="color: #ffa54f"></a-entity>
		<a-entity id="hangBox1" geometry="primitive:box; width: 3; height: 1; depth: 1;" position=" 5 6  0" rotation="0 90 0" material="color: #ffa54f"></a-entity>
		<a-entity id="hangBox1" geometry="primitive:box; width: 3; height: 1; depth: 1;" position=" 0 6  5" rotation="0  0 0" material="color: #ffa54f"></a-entity>
		<a-entity id="hangBox1" geometry="primitive:box; width: 3; height: 1; depth: 1;" position="-5 6 0" rotation="0 90 0" material="color: #ffa54f"></a-entity>

		<a-entity id="bulletTemplate" bullet geometry="primitive: icosahedron; radius: 0.05;" material="color: orange;"></a-entity>

		<a-camera id="camera" position="0 3 0">
		    <a-cursor shooter click-to-shoot></a-cursor>
	    </a-camera>

	    <a-entity geometry="primitive: plane; width: 10000; height: 10000;" rotation="-90 0 0" material="color:#7BC8A4"></a-entity>

	    <a-sky id="background" src="#skyTexture" theta-length="91" radius="30"></a-sky>

	    <a-entity light="type: ambient; color: #FFF; intensity: 0.6"></a-entity>
	    <a-entity light="type: directional; color: #FFF; intensity: 0.8" position="0 5 4"></a-entity>

	</a-scene>
</body>
</html>